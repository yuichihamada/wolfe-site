{% extends 'base.html' %}
{% block title %}相談BOX - REBIRTH Connect{% endblock %}

{% block content %}
<section class="max-w-4xl mx-auto px-4 py-10">

  <!-- 説明部分 -->
  <header class="mb-6 md:mb-8">

    <h1 class="text-2xl md:text-3xl font-bold mb-3">
      相談BOX
    </h1>

    {# ▼ スマホ用の短め説明 #}
    <p class="text-sm text-gray-600 leading-relaxed mb-2 md:hidden">
      チームへの要望・意見などを、気軽に送れるBOXです。
    </p>

    {# ▼ PC/タブレット用の丁寧説明 #}
    <p class="hidden md:block text-base text-gray-600 leading-relaxed mb-2">
      チームへの要望・意見など、どんなことでも気軽に送れるBOXです。<br>
    </p>
    
  </header>

  <!-- 投稿フォーム -->
  <section class="bg-white border rounded-lg shadow-sm p-4 md:p-6 mb-12">
    {% if messages %}
      <div class="space-y-2 mb-4">
        {% for message in messages %}
          <p class="text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded px-3 py-2">
            {{ message }}
          </p>
        {% endfor %}
      </div>
    {% endif %}

    {# スマホではフォームだけ横幅を広げるラッパー #}
    <div class="-mx-4 md:mx-0">
      <form method="post" class="space-y-4 px-4 md:px-0 w-full">
        {% csrf_token %}

        <!-- お名前 -->
        <div>
          <label class="block text-sm font-medium mb-1">
            {{ form.name.label }}
          </label>
          {{ form.name }}
          {% if form.name.errors %}
            <p class="text-xs text-red-600 mt-1">
              {{ form.name.errors|striptags }}
            </p>
          {% endif %}
        </div>

        <!-- カテゴリ -->
        <div>
          <label class="block text-sm font-medium mb-1">
            {{ form.category.label }}
          </label>
          {{ form.category }}
          {% if form.category.errors %}
            <p class="text-xs text-red-600 mt-1">
              {{ form.category.errors|striptags }}
            </p>
          {% endif %}
        </div>

        <!-- 内容 -->
        <div>
          <label class="block text-sm font-medium mb-1">
            {{ form.body.label }}
          </label>
          {{ form.body }}
          {% if form.body.errors %}
            <p class="text-xs text-red-600 mt-1">
              {{ form.body.errors|striptags }}
            </p>
          {% endif %}
        </div>

        <!-- ボタン -->
        <div class="flex flex-col gap-3 pt-2 md:flex-row md:items-center md:justify-between">
          <div class="text-right">
            <button
              type="submit"
              class="inline-flex w-full justify-center md:w-auto px-4 py-2 rounded-md bg-emerald-600 text-white text-sm font-semibold hover:bg-emerald-700">
              この内容で送信する
            </button>
          </div>
        </div>
      </form>
    </div>
  </section>

  <!-- 公開Q&Aエリア -->
  <section>
    <div class="flex items-center justify-between mb-4">
      <div>
        <h2 class="text-lg md:text-xl font-semibold">
          みんなのQ&amp;A
        </h2>
      </div>
    </div>

    {% if public_faqs %}
      <div class="space-y-4">
        {% for faq in public_faqs %}
          <article class="bg-white border rounded-lg p-4 md:p-5 shadow-sm">
            <!-- カテゴリ・日付 -->
            <div class="flex items-center justify-between mb-2">
              <span class="inline-flex items-center px-2 py-0.5 rounded-full text-[11px] font-semibold
                            bg-emerald-50 text-emerald-700 border border-emerald-200">
                {{ faq.get_category_display }}
              </span>
              <span class="text-[11px] text-gray-500">
                {{ faq.created_at|date:"Y/m/d" }}
              </span>
            </div>

            <!-- 質問部分 -->
            <div class="mb-3">
              <p class="text-xs font-semibold text-gray-600 mb-1">質問</p>
              <p class="text-sm whitespace-pre-line text-gray-800">
                {{ faq.question_text }}
              </p>
            </div>

            <!-- 回答部分 -->
            <div class="border-t pt-3 mt-2">
              <p class="text-xs font-semibold text-emerald-700 mb-1">回答</p>
              <p class="text-sm whitespace-pre-line text-gray-900 leading-relaxed">
                {{ faq.answer }}
              </p>
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-sm text-gray-500">
        まだ公開中のQ&amp;Aはありません。<br class="hidden md:inline">
        これから寄せられる相談やご意見をもとに、少しずつ増やしていきます。
      </p>
    {% endif %}
  </section>

</section>
{% endblock %}
